<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SLSH - স্মার্ট হাজিরা</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @font-face {
            font-family: 'iOS Bangla';
            src: url('../assets/fonts/iOS Bangla Font.ttf') format('truetype');
        }

        body {
            background-color: #020408;
            color: #e2e8f0;
            font-family: 'iOS Bangla', sans-serif;
            background-image: radial-gradient(circle at 50% -20%, #1e293b 0%, transparent 50%);
            min-height: 100vh;
        }

        .glass {
            background: rgba(255, 255, 255, 0.02);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 20px;
        }

        .iphone-scroll::-webkit-scrollbar { width: 4px; }
        .iphone-scroll::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.1); border-radius: 10px; }

        .btn-present.active { background-color: #10b981 !important; color: white; border-color: #10b981; }
        .btn-absent.active { background-color: #ef4444 !important; color: white; border-color: #ef4444; }
        
        #notification-container {
            position: fixed; top: 20px; right: 20px; z-index: 1000;
            display: flex; flex-direction: column; gap: 10px;
        }
        .toast {
            animation: slideIn 0.3s ease-out forwards;
            background: rgba(15, 23, 42, 0.95);
            border-left: 4px solid #3b82f6;
            padding: 12px 20px; border-radius: 12px; color: white;
            display: flex; align-items: center; gap: 10px; box-shadow: 0 10px 20px rgba(0,0,0,0.4);
        }
        @keyframes slideIn { from { transform: translateX(100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
    </style>
</head>
<body class="p-4 md:p-8">

    <div id="notification-container"></div>

    <div class="max-w-4xl mx-auto">
        <!-- Header -->
        <header class="flex justify-between items-center mb-8">
            <button onclick="goBack()" class="glass p-3 hover:bg-white/10 transition-all">
                <i data-lucide="arrow-left"></i>
            </button>
            <h1 class="text-xl font-bold">স্মার্ট হাজিরা সিস্টেম</h1>
            <div class="glass px-4 py-2 text-xs font-mono text-blue-400">০৫ ফেব, ২০২৬</div>
        </header>

        <!-- Selection Controls -->
        <div class="glass p-6 mb-6 flex flex-col md:flex-row gap-4 items-end">
            <div class="flex-1 w-full">
                <label class="text-[10px] text-slate-500 uppercase font-bold mb-2 block tracking-widest">শ্রেণী নির্বাচন করুন</label>
                <select id="class-select" class="w-full bg-white/5 border border-white/10 rounded-xl p-3 outline-none focus:border-blue-500">
                    <option value="৬ষ্ঠ">৬ষ্ঠ শ্রেণী</option>
                    <option value="৭ম">৭ম শ্রেণী</option>
                    <option value="৮ম">৮ম শ্রেণী</option>
                    <option value="৯ম">৯ম শ্রেণী</option>
                    <option value="১০ম">১০ম শ্রেণী</option>
                </select>
            </div>
            <div class="flex gap-4 w-full md:w-auto">
                <div class="glass px-6 py-3 text-center min-w-[100px]">
                    <p class="text-[9px] text-slate-500 uppercase">উপস্থিত</p>
                    <h2 id="present-count" class="text-xl font-bold text-green-400">০</h2>
                </div>
                <div class="glass px-6 py-3 text-center min-w-[100px]">
                    <p class="text-[9px] text-slate-500 uppercase">অনুপস্থিত</p>
                    <h2 id="absent-count" class="text-xl font-bold text-red-400">০</h2>
                </div>
            </div>
        </div>

        <!-- Student List -->
        <div class="glass overflow-hidden mb-6">
            <div class="p-4 border-b border-white/5 bg-white/5 flex justify-between items-center">
                <span id="list-title" class="font-bold text-sm text-blue-400">শিক্ষার্থী তালিকা (১০০ জন)</span>
                <span class="text-[10px] text-slate-500 italic">হাজিরা নিতে P বা A ক্লিক করুন</span>
            </div>
            <div class="overflow-y-auto max-h-[500px] iphone-scroll" id="student-container">
                <!-- Students will be generated here -->
            </div>
        </div>

        <!-- Submit Button -->
        <button id="submit-btn" onclick="submitAttendance()" class="w-full bg-blue-600 hover:bg-blue-500 py-4 rounded-2xl font-bold shadow-lg shadow-blue-500/20 transition-all flex items-center justify-center gap-2">
            <i data-lucide="send" class="w-5 h-5"></i> হাজিরা নিশ্চিত করুন এবং মেসেজ পাঠান
        </button>
    </div>

    <script>
        lucide.createIcons();

        let attendanceData = {}; 

        // Generate 100 students
        function generateStudents() {
            const container = document.getElementById('student-container');
            let html = '';
            for (let i = 1; i <= 100; i++) {
                const roll = i.toString().padStart(3, '0');
                html += `
                    <div class="p-4 flex justify-between items-center border-b border-white/5 hover:bg-white/[0.02] transition-colors">
                        <div class="flex items-center gap-4">
                            <span class="font-mono text-xs text-slate-500">#${roll}</span>
                            <div>
                                <h4 class="text-sm font-bold">শিক্ষার্থী নম্বর - ${i}</h4>
                                <p class="text-[10px] text-slate-400">মোবাইল: ০১৭xxxxxxxx</p>
                            </div>
                        </div>
                        <div class="flex gap-2">
                            <button onclick="mark(${i}, 'A')" id="btn-a-${idGenerator(i)}" class="btn-absent glass px-4 py-2 text-[10px] font-bold border-red-500/20 hover:bg-red-500/20 transition-all">ABSENT</button>
                            <button onclick="mark(${i}, 'P')" id="btn-p-${idGenerator(i)}" class="btn-present glass px-4 py-2 text-[10px] font-bold border-green-500/20 hover:bg-green-500/20 transition-all">PRESENT</button>
                        </div>
                    </div>
                `;
            }
            container.innerHTML = html;
            lucide.createIcons();
        }
        
        // Helper to avoid duplicate IDs in loop logic if needed
        function idGenerator(i) { return i; }

        function mark(id, status) {
            attendanceData[id] = status;
            
            // Reset and set active
            document.getElementById(`btn-a-${id}`).classList.remove('active');
            document.getElementById(`btn-p-${id}`).classList.remove('active');
            
            if(status === 'P') {
                document.getElementById(`btn-p-${id}`).classList.add('active');
            } else {
                document.getElementById(`btn-a-${id}`).classList.add('active');
            }

            updateCounts();
        }

        function updateCounts() {
            const values = Object.values(attendanceData);
            const present = values.filter(v => v === 'P').length;
            const absent = values.filter(v => v === 'A').length;
            
            document.getElementById('present-count').innerText = present;
            document.getElementById('absent-count').innerText = absent;
        }

        function showToast(message, color = '#3b82f6') {
            const container = document.getElementById('notification-container');
            const toast = document.createElement('div');
            toast.className = 'toast';
            toast.style.borderLeftColor = color;
            toast.innerHTML = `<i data-lucide="bell" class="w-4 h-4"></i> <span class="text-xs font-bold">${message}</span>`;
            container.appendChild(toast);
            lucide.createIcons();
            setTimeout(() => toast.remove(), 4000);
        }

        function goBack() {
            // Force redirect to dashboard
            window.location.href = '../dashboards/school-college-dashboard.html';
        }

        function submitAttendance() {
            const btn = document.getElementById('submit-btn');
            const className = document.getElementById('class-select').value;
            const absentCount = document.getElementById('absent-count').innerText;

            // UI Feedback
            btn.disabled = true;
            btn.innerText = "প্রসেসিং হচ্ছে...";
            btn.style.opacity = "0.7";

            showToast(`${className} শ্রেণীর হাজিরা ডাটাবেজে সংরক্ষিত হয়েছে।`, '#10b981');
            
            if(parseInt(absentCount) > 0) {
                setTimeout(() => {
                    showToast(`${absentCount} জন অভিভাবকের মোবাইলে অটো-মেসেজ পাঠানো হয়েছে।`, '#ef4444');
                }, 1000);
            }

            // Redirect back to dashboard after 2.5 seconds
            setTimeout(() => {
                goBack();
            }, 2500);
        }

        window.onload = generateStudents;
    </script>
</body>
</html>


